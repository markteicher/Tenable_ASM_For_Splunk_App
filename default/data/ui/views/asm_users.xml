<dashboard version="1.1">
  <label>Tenable ASM â€“ Users</label>
  <description>
    User accounts with access to Tenable Attack Surface Management.
  </description>

  <!-- ========================= -->
  <!-- KPI -->
  <!-- ========================= -->
  <row>
    <panel>
      <title>Total Users</title>
      <single>
        <search>
          <query>
            index=$ASM_INDEX$ sourcetype=asm:users
            | stats count
          </query>
        </search>
        <option name="drilldown">none</option>
      </single>
    </panel>
  </row>

  <!-- ========================= -->
  <!-- User Details -->
  <!-- ========================= -->
  <row>
    <panel>
      <title>User Details</title>
      <table>
        <search>
          <query>
            index=$ASM_INDEX$ sourcetype=asm:users
            | table
                id
                name
                email
                role
                status
                created_at
                updated_at
            | sort name
          </query>
        </search>

        <option name="count">25</option>
        <option name="wrap">true</option>
        <option name="drilldown">row</option>

        <!-- Drilldown from Activity -->
        <drilldown>
          <link>
            <![CDATA[
            /app/$app$/asm_user_activity
            ?actor=$row.name$
            &email=$row.email$
            ]]>
          </link>
        </drilldown>

      </table>
    </panel>
  </row>

</dashboard>
