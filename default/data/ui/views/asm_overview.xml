<dashboard version="1.1">
  <label>Tenable Attack Surface Management â€“ Overview</label>
  <description>
    High-level operational and inventory overview of Tenable Attack Surface Management data ingested into Splunk.
  </description>

  <!-- ========================= -->
  <!-- Key Metrics -->
  <!-- ========================= -->
  <row>
    <panel>
      <title>Total Assets</title>
      <single>
        <search>
          <query>
            index=$ASM_INDEX$ sourcetype=tenable:asm:asset
            | stats count
          </query>
        </search>
        <option name="drilldown">none</option>
      </single>
    </panel>

    <panel>
      <title>Total Inventories</title>
      <single>
        <search>
          <query>
            index=$ASM_INDEX$ sourcetype=tenable:asm:inventory
            | stats count
          </query>
        </search>
        <option name="drilldown">none</option>
      </single>
    </panel>

    <panel>
      <title>Active Suggestions</title>
      <single>
        <search>
          <query>
            index=$ASM_INDEX$ sourcetype=tenable:asm:suggestion
            | where isnull(deleted_at)
            | stats count
          </query>
        </search>
        <option name="drilldown">none</option>
      </single>
    </panel>
  </row>

  <!-- ========================= -->
  <!-- Assets by Severity -->
  <!-- ========================= -->
  <row>
    <panel>
      <title>Assets by Severity</title>
      <chart>
        <search>
          <query>
            index=$ASM_INDEX$ sourcetype=tenable:asm:asset
            | stats count by bd.severity_ranking
            | sort - count
          </query>
        </search>
        <option name="charting.chart">pie</option>
        <option name="drilldown">none</option>
      </chart>
    </panel>
  </row>

  <!-- ========================= -->
  <!-- Severity Trend (Ingest-Based) -->
  <!-- ========================= -->
  <row>
    <panel>
      <title>Severity Trend</title>
      <chart>
        <search>
          <query>
            index=$ASM_INDEX$ sourcetype=tenable:asm:asset
            | eval ingest_day=strftime(_time,"%Y-%m-%d")
            | stats count by ingest_day bd.severity_ranking
            | sort ingest_day
          </query>
        </search>
        <option name="charting.chart">area</option>
        <option name="charting.stackMode">stacked</option>
        <option name="drilldown">none</option>
      </chart>
    </panel>
  </row>

  <!-- ========================= -->
  <!-- Ingest Volume -->
  <!-- ========================= -->
  <row>
    <panel>
      <title>Records Ingested (All Time)</title>
      <chart>
        <search>
          <query>
            index=$ASM_INDEX$
            | timechart span=1h count
          </query>
        </search>
        <option name="charting.chart">column</option>
        <option name="drilldown">none</option>
      </chart>
    </panel>
  </row>

</dashboard>
