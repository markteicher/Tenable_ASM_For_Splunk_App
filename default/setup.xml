<setup>
  <block title="Tenable Attack Surface Management â€“ Setup">

    <!-- ========================= -->
    <!-- Connection Configuration -->
    <!-- ========================= -->

    <input type="password">
      <label>ASM API Key</label>
      <name>asm_api_key</name>
      <help>Enter your Tenable Attack Surface Management API key.</help>
    </input>

    <input type="text">
      <label>Index Name</label>
      <name>index</name>
      <default>security_tenable_asm</default>
      <help>Splunk index where ASM data will be stored.</help>
    </input>

    <!-- ========================= -->
    <!-- Proxy Configuration -->
    <!-- ========================= -->

    <block title="Proxy Configuration (Optional)">

      <input type="text">
        <label>Proxy Host</label>
        <name>proxy_host</name>
        <help>Proxy hostname or IP (leave blank if not used).</help>
      </input>

      <input type="text">
        <label>Proxy Port</label>
        <name>proxy_port</name>
        <help>Proxy port.</help>
      </input>

      <input type="text">
        <label>Proxy Username</label>
        <name>proxy_username</name>
        <help>Optional proxy username.</help>
      </input>

      <input type="password">
        <label>Proxy Password</label>
        <name>proxy_password</name>
        <help>Optional proxy password.</help>
      </input>

      <button>
        <label>Test Proxy Connectivity</label>
        <endpoint>/services/asm/proxy_test</endpoint>
      </button>

    </block>

    <!-- ========================= -->
    <!-- Authentication Test -->
    <!-- ========================= -->

    <button>
      <label>Test ASM API Authentication</label>
      <endpoint>/services/asm/auth_test</endpoint>
    </button>

    <!-- ========================= -->
    <!-- ASM Component Selection -->
    <!-- ========================= -->

    <block title="ASM Components to Ingest">

      <input type="checkbox">
        <label>Enable Asset Inventory</label>
        <name>enable_assets</name>
        <default>true</default>
      </input>

      <input type="checkbox">
        <label>Enable Inventories</label>
        <name>enable_inventories</name>
        <default>true</default>
      </input>

      <input type="checkbox">
        <label>Enable Suggestions</label>
        <name>enable_suggestions</name>
        <default>true</default>
      </input>

      <input type="checkbox">
        <label>Enable Alerts</label>
        <name>enable_alerts</name>
        <default>true</default>
      </input>

      <input type="checkbox">
        <label>Enable Subscriptions</label>
        <name>enable_subscriptions</name>
        <default>true</default>
      </input>

      <input type="checkbox">
        <label>Enable TXT Records</label>
        <name>enable_txt_records</name>
        <default>false</default>
      </input>

      <input type="checkbox">
        <label>Enable Activity Logs</label>
        <name>enable_logs</name>
        <default>false</default>
      </input>

    </block>

    <!-- ========================= -->
    <!-- Save Configuration -->
    <!-- ========================= -->

    <button>
      <label>Save Configuration</label>
      <endpoint>/services/asm/save</endpoint>
    </button>

  </block>
</setup>
