<setup>
  <header>Tenable Attack Surface Management for Splunk</header>

  <block title="Tenable ASM Connection">
    <text>
      Enter your Tenable Attack Surface Management API key.
    </text>

    <input type="password">
      <label>ASM API Key</label>
      <key>asm_api_key</key>
      <help>
        API key used to authenticate to asm.cloud.tenable.com
      </help>
    </input>
  </block>

  <block title="Proxy Configuration (Optional)">
    <text>
      Configure an outbound proxy if required to reach Tenable ASM.
    </text>

    <input type="text">
      <label>Proxy Host</label>
      <key>proxy_host</key>
      <help>Example: proxy.company.com</help>
    </input>

    <input type="text">
      <label>Proxy Port</label>
      <key>proxy_port</key>
      <help>Example: 8080</help>
    </input>

    <input type="text">
      <label>Proxy Username</label>
      <key>proxy_user</key>
    </input>

    <input type="password">
      <label>Proxy Password</label>
      <key>proxy_pass</key>
    </input>
  </block>

  <block title="Splunk Index">
    <text>
      Specify the Splunk index where Tenable ASM data will be stored.
      The index must already exist.
    </text>

    <input type="text">
      <label>Target Index</label>
      <key>asm_index</key>
      <default>security_tenable_asm</default>
      <help>
        Example: security_tenable_asm
      </help>
    </input>
  </block>

  <block title="ASM Data Components">
    <text>
      Select which Tenable ASM components should be ingested.
    </text>

    <input type="checkbox">
      <label>Enable Components</label>
      <key>enabled_components</key>

      <choice value="assets">Assets</choice>
      <choice value="inventory">Inventory</choice>
      <choice value="suggestions">Suggestions</choice>
      <choice value="subscriptions">Subscriptions</choice>
      <choice value="alerts">Alerts</choice>
      <choice value="logs">User Activity Logs</choice>
      <choice value="txt_records">TXT Records</choice>
      <choice value="dashboard">Dashboard Summary</choice>
      <choice value="tags">Tags</choice>
      <choice value="sources">Sources</choice>

      <default>assets,inventory,suggestions</default>
    </input>
  </block>

  <block title="Save Configuration">
    <text>
      Click Save to apply configuration and enable data collection.
    </text>
  </block>
</setup>
