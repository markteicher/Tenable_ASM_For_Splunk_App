############################################################
# Tenable Attack Surface Management – Sourcetype Definitions
############################################################

############################
# ASM Assets
############################
[tenable:asm:asset]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TRUNCATE = 0
KV_MODE = json
AUTO_KV_JSON = true
NO_BINARY_CHECK = true
TIME_PREFIX = "bd.last_metadata_change\":\s*\""
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
MAX_TIMESTAMP_LOOKAHEAD = 30

############################
# ASM Inventories
############################
[tenable:asm:inventory]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = json
AUTO_KV_JSON = true
TRUNCATE = 0
NO_BINARY_CHECK = true
# inventory objects do not expose a stable timestamp → index-time default

############################
# ASM Suggestions
############################
[tenable:asm:suggestion]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = json
AUTO_KV_JSON = true
TRUNCATE = 0
NO_BINARY_CHECK = true
# suggestion timestamps vary by status → index-time default

############################
# ASM Alerts
############################
[tenable:asm:alert]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = json
AUTO_KV_JSON = true
TRUNCATE = 0
NO_BINARY_CHECK = true
# alerts do not provide a guaranteed event-time field

############################
# ASM Subscriptions
############################
[tenable:asm:subscription]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = json
AUTO_KV_JSON = true
TRUNCATE = 0
NO_BINARY_CHECK = true

############################
# ASM TXT Records
############################
[tenable:asm:txt_record]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = json
AUTO_KV_JSON = true
TRUNCATE = 0
NO_BINARY_CHECK = true

############################
# ASM User Action Logs
############################
[tenable:asm:activity]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = json
AUTO_KV_JSON = true
TRUNCATE = 0
NO_BINARY_CHECK = true
TIME_PREFIX = "created_at\":\s*\""
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
MAX_TIMESTAMP_LOOKAHEAD = 30

############################
# ASM Operational Metrics
############################
[tenable:asm:ops]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = json
AUTO_KV_JSON = true
TRUNCATE = 0
NO_BINARY_CHECK = true
# ops metrics are synthetic → index-time is correct
