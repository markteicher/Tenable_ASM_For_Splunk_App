############################################################
# Tenable Attack Surface Management – App Settings
# Managed exclusively by setup.xml + REST handlers
# This file defines Splunk-side ingestion behavior only.
############################################################

[global]

########################
# Authentication (ASM)
########################
# REQUIRED
asm_api_key =

########################
# Target Index
########################
# REQUIRED – user-defined, never hardcoded
asm_index =

########################
# Proxy Configuration
########################
proxy_enabled = false
proxy_scheme = http
proxy_host =
proxy_port =
proxy_username =
proxy_password =

########################
# Component Toggles
########################
# Enable/disable individual ASM data sources
enable_assets = false
enable_inventories = false
enable_suggestions = false
enable_subscriptions = false
enable_txt_records = false
enable_activity_logs = false

########################
# Collection Intervals (seconds)
########################
interval_assets = 3600
interval_inventories = 7200
interval_suggestions = 1800
interval_subscriptions = 14400
interval_txt_records = 21600
interval_activity_logs = 600

########################
# Request & Transport Controls
########################
# Network + API safety
request_timeout = 60
connect_timeout = 15

########################
# Retry & Backoff Controls
########################
# Applied to ALL ASM endpoints
max_retries = 5
retry_backoff_seconds = 30
retry_on_http = 429,500,502,503,504

########################
# Pagination Controls
########################
# ASM cursor/page handling
page_size = 100
max_pages = 0
# max_pages = 0 means "no artificial limit"

########################
# Ingest Safety Controls (Splunk-side)
########################
# These do NOT imply ASM features.
# They control how the Splunk app behaves when ASM payloads change.
preserve_unknown_fields = true
allow_optional_fields = true
drop_null_fields = false

########################
# Operational Telemetry
########################
# Generate internal events for dashboards
enable_operational_metrics = true
enable_error_events = true
enable_ingest_heartbeat = true

########################
# Logging Controls
########################
log_level = INFO
log_payload_errors = true
log_http_errors = true

########################
# State & Checkpointing
########################
# Prevent duplicate ingestion
enable_cursor_state = true
state_backend = kvstore
state_ttl_seconds = 604800
