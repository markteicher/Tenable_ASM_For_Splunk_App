############################################################
# Tenable Attack Surface Management â€“ App Settings
# Managed by setup.xml + REST handlers
#
# default/ = schema + safe defaults
# local/   = runtime values (user config)
############################################################

[global]

########################
# Authentication (Required)
########################
asm_api_key =

########################
# Target Index (Required, user-defined)
########################
asm_index =

########################
# Proxy Configuration
########################
proxy_enabled = false
proxy_scheme =            # http | https | socks5
proxy_host =
proxy_port =
proxy_username =
proxy_password =

# Proxy validation targets
proxy_test_google = true
proxy_test_asm = true
proxy_connect_timeout_seconds = 10

########################
# Component Toggles (ASM only)
########################
enable_assets = false
enable_inventories = false
enable_suggestions = false
enable_suggestion_counts = false
enable_txt_records = false
enable_subscriptions = false
enable_admin_users = false
enable_user_action_logs = false
enable_limits = false

########################
# Collection Intervals (seconds)
########################
interval_assets = 3600
interval_inventories = 7200
interval_suggestions = 1800
interval_suggestion_counts = 900
interval_txt_records = 21600
interval_subscriptions = 14400
interval_admin_users = 43200
interval_user_action_logs = 600
interval_limits = 21600

########################
# HTTP / Retry / Backoff
########################
request_timeout_seconds = 60
connect_timeout_seconds = 10

max_retries = 5
retry_backoff_seconds = 30
retry_jitter_seconds = 5
respect_retry_after = true
throttle_on_http_429 = true

########################
# Pagination / Limits
########################
page_size = 100
max_pages_per_run = 10000

# Cursor / checkpoint support for endpoints that support paging
enable_checkpointing = true
checkpoint_stale_seconds = 86400

########################
# Operational Telemetry (Splunk events)
########################
enable_operational_metrics = true
enable_error_events = true
enable_health_heartbeat = true

heartbeat_sourcetype = tenable:asm:health
metrics_sourcetype   = tenable:asm:metrics
error_sourcetype     = tenable:asm:error

########################
# Failure Handling / Self-protection
########################
fail_closed = false
fail_closed_threshold = 5

auto_disable_on_auth_failure = true
auto_disable_on_repeated_429 = true
auto_disable_on_schema_failure = true

########################
# Limits Tracking (ASM /asset-limit)
########################
enable_limit_tracking = true
limit_warning_threshold_percent = 80
limit_critical_threshold_percent = 95

########################
# Logging Controls
########################
log_level = INFO
log_http_errors = true
log_payload_errors = true
log_schema_mismatches = true

########################
# Schema Drift Handling
########################
preserve_unknown_fields = true
